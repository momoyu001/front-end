<!DOCTYPE html>
<html lang="ch">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JS作用域</title>
</head>
<body>
    
    <script>
        // script 全局作用域，预编译时产生一个GO对象，GO和AO都存储在[[scope]]
        // var gloab
        // // 函数执行的时候才有自己的ao
        // function a() {
        //     // a 函数执行的时候。进入这里面，b才被定义
        //     function b() {
        //         // b执行的时候，1、b自己的AO   2、a函数的AO  3、GO
        //         var bb = 123
        //         aa = 0;
        //     }
        //     var aa = 234
        // }

        // // a执行的时候，作用域链，最顶端放的是自己的AO，第二位方的是外面的GO，执行完之后，会销毁
        // a();


        // 闭包：可以让变量一直保存再内存中
        // 定义b函数的时候，看得到a的ao对象，就算a销毁了，执行b的时候，还是可以访问到a里面的变量等
        function a() {
            var aa = 123;
            function b() {
                var bb = 234;
                console.log(aa);    // 123
            }

            return b;
        }

        var res = a();

        res();
    </script>

    <!-- 
        # 作用域 --- 一般指 一个变量的作用范围
        ## 全局作用域：
        1、页面打开时被创建，关闭时被销毁
        2、script标签中的函数和变量，作用域为全局，在页面任何位置都可以访问到
        3、全局作用域中有对象window，代表一个浏览器窗口，由浏览器创建，可以直接调用
        4、全局作用域中声明的变量和函数会作为window对象的属性和方法保存

        ## 函数作用域：
        1、调用函数时，函数作用域被创建，函数执行完毕，函数作用域被销毁
        2、每调用一次函数，就会创建一个新的函数作用域，他们之间是独立的
        3、在函数作用域中可以访问到全局作用域的变量，在函数外无法访问到函数作用域内的变量
        4、函数作用域中访问变量、函数时，会先在自身作用域中寻找，若没有找到，则会到函数的上一级作用域中寻找，一直到全局作用域。


        # 作用域的深层次理解：
        1、执行期上下文
            当函数代码执行的前期，会创建一个执行期上下文的内部对象AO（作用域）
            这个内部的对象是预编译的时候创建出来的，因为当函数被调用的时候，会先进行预编译
            在全局代码执行的前期会创建一个执行期上下文的对象GO

        tips: 不管是全局还是函数，在执行前，都会进行预编译 AO对象 / GO对象


        # 函数作用域预编译
        1、创建ao对象 AO{}
        2、找形参和实参，将变量和形参名 当做 AO对象的属性名 值为undefined
        3、形参和实参相统一
        4、在函数体里面找函数声明，值赋予函数体

        # 全局作用域的预编译
        1、创建 GO对象
        2、找变量声明，将变量声明作为GO对象的属性名 值是undefined
        3、找函数声明，值赋予函数体
     -->

    <!-- 
        作用域链：
            会被保存到一个隐式的属性中去 [[scope]] 这个属性是我们用于访问不到的，但是的的确确存在的，让js引擎来访问的，里面存储的就是作用域链
            AO GO - 作用域
            AO GO 的集合 - 作用域链
    -->
</body>
</html>